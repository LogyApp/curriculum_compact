<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <title>Registro Hoja de Vida - Logyser</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <link rel="stylesheet" href="./index.css">
</head>

<body>
  <div class="page">
    <div class="card">
      <div class="header">
        <img src="https://storage.googleapis.com/encuesta_satisfaccion/logo.png" alt="Logo Logyser" />
        <div>
          <h1>Registro de Hoja de Vida</h1>
          <p class="subtitle">
            Diligencia tu información en pocos pasos. Si ya te has registrado antes,
            podrás actualizar tus datos con tu número de identificación.
          </p>
        </div>
      </div>

      <!-- STEPPER -->
      <div class="stepper" id="stepper">
        <div class="step active" data-step="0">
          <div class="step-number">1</div>
          <div class="step-label">Ingreso</div>
        </div>

        <div class="step" data-step="1">
          <div class="step-number">2</div>
          <div class="step-label">Medio de reclutamiento</div>
        </div>

        <div class="step" data-step="2">
          <div class="step-number">3</div>
          <div class="step-label">Datos personales</div>
        </div>

        <div class="step" data-step="3">
          <div class="step-number">4</div>
          <div class="step-label">Educación</div>
        </div>

        <div class="step" data-step="4">
          <div class="step-number">5</div>
          <div class="step-label">Experiencia</div>
        </div>

        <div class="step" data-step="5">
          <div class="step-number">6</div>
          <div class="step-label">Familia / Referencias</div>
        </div>

        <div class="step" data-step="6">
          <div class="step-number">7</div>
          <div class="step-label">Emergencia / Metas</div>
        </div>

        <div class="step" data-step="7">
          <div class="step-number">8</div>
          <div class="step-label">Cuestionario</div>
        </div>

        <div class="step" data-step="8">
          <div class="step-number">9</div>
          <div class="step-label">Revisión</div>
        </div>
      </div>

      <!-- FORM -->
      <form id="hv-form">
        <!-- PASO 0: INGRESO -->
        <div class="form-step active" data-step="0">
          <div class="step-title">Ingreso al formulario</div>
          <p class="help-text">
            Ingresa tu tipo y número de identificación. Si ya tienes información registrada,
            la cargaremos automáticamente para que solo actualices lo que haga falta.
          </p>

          <div class="grid">
            <div class="field">
              <label for="tipo_documento_ingreso">
                Tipo de identificación <span class="required">*</span>
              </label>
              <select id="tipo_documento_ingreso" data-required="true">
                <option value="">Selecciona...</option>
              </select>
            </div>

            <div class="field">
              <label for="identificacion_ingreso">
                Número de identificación <span class="required">*</span>
              </label>
              <input type="text" id="identificacion_ingreso" data-required="true" />
            </div>
          </div>

          <div id="ingreso-msg" class="error-message" style="margin-top:10px;"></div>
        </div>

        <!-- PASO 1: MEDIO DE RECLUTAMIENTO -->
        <div class="form-step" data-step="1">
          <div class="step-title">Paso 1: ¿Cómo llegaste a la oferta?</div>
          <div class="grid">
            <div class="field">
              <label for="medio_reclutamiento">
                Medio de reclutamiento <span class="required">*</span>
              </label>
              <select id="medio_reclutamiento" name="medio_reclutamiento" data-required="true">
                <option value="">Selecciona una opción</option>
                <option value="proceso_seleccion">Proceso Selección</option>
                <option value="pagina_web">Página web Logyser</option>
                <option value="plataforma_empleo">Plataforma de empleo</option>
                <option value="redes_sociales">Redes sociales</option>
                <option value="recomendado">Recomendado</option>
                <option value="empleado_interno">Empleado interno</option>
                <option value="agencia">Agencia de empleo</option>
                <option value="otro">Otro</option>
              </select>
              <div class="help-text">
                Esta información nos ayuda a mejorar nuestros canales de reclutamiento.
              </div>
            </div>

            <div class="field hidden" id="campo-recomendador">
              <label for="recomendador_aspirante">
                ¿Quién te recomendó? / Nombre del contacto
              </label>
              <input type="text" id="recomendador_aspirante" name="recomendador_aspirante"
                placeholder="Nombre de la persona o entidad" />
            </div>
          </div>
          <div id="error-step-1" class="error-message"></div>
        </div>

        <!-- PASO 2: DATOS PERSONALES -->
        <div class="form-step" data-step="2">
          <div class="step-title">Paso 2: Datos personales</div>
          <div class="grid">
            <div class="field">
              <label for="tipo_documento">
                Tipo de identificación <span class="required">*</span>
              </label>
              <select id="tipo_documento" name="tipo_documento" data-required="true">
                <option value="">Selecciona...</option>
              </select>

            </div>

            <div class="field">
              <label for="identificacion">
                Número de identificación <span class="required">*</span>
              </label>
              <input type="text" id="identificacion" name="identificacion" data-required="true" />
            </div>
            <div id="ingreso-summary" class="field-help" style="margin-top:8px; display:none;">
              Ingreso: <strong id="ingreso-summary-text"></strong>
              <button type="button" class="btn btn-secondary" id="edit-ingreso" style="margin-left:8px;">Editar</button>
            </div>
            <!-- Inserta este bloque en Paso 2 (Datos personales) — recomiendo colocarlo justo después de #ingreso-summary -->
            <div class="field" id="photo-field" style="margin-top:10px;">
              <label>Foto de perfil <span class="required">*</span></label>
              <div style="display:flex; align-items:center; gap:12px; margin-top:6px;">
                <img id="photo-img" src="" alt="Foto de perfil"
                  style="width:96px; height:96px; object-fit:cover; border-radius:8px; border:1px solid var(--border); display:none;" />
                <div id="photo-placeholder" style="color:var(--muted);">No hay foto cargada</div>
              </div>

              <input type="file" id="photo_input" accept="image/png, image/jpeg" style="margin-top:8px;" />
              <div class="help-text">Formatos aceptados: JPG / PNG. Máx 5 MB.</div>

              <div style="margin-top:8px; display:flex; gap:8px;">
                <button type="button" id="btn-upload-photo" class="btn btn-secondary">Subir foto</button>
                <button type="button" id="btn-remove-photo" class="btn btn-secondary hidden">Eliminar</button>
                <span id="photo-status" style="align-self:center; color:var(--muted); font-size:0.9rem;"></span>
              </div>
            </div>
            <div class="field">
              <label for="primer_nombre">
                Primer nombre <span class="required">*</span>
              </label>
              <input type="text" id="primer_nombre" name="primer_nombre" data-required="true" />
            </div>

            <div class="field">
              <label for="segundo_nombre">Segundo nombre</label>
              <input type="text" id="segundo_nombre" name="segundo_nombre" />
            </div>

            <div class="field">
              <label for="primer_apellido">
                Primer apellido <span class="required">*</span>
              </label>
              <input type="text" id="primer_apellido" name="primer_apellido" data-required="true" />
            </div>

            <div class="field">
              <label for="segundo_apellido">Segundo apellido</label>
              <input type="text" id="segundo_apellido" name="segundo_apellido" />
            </div>

            <div class="field">
              <label for="fecha_nacimiento">
                Fecha de nacimiento <span class="required">*</span>
              </label>
              <input type="date" id="fecha_nacimiento" name="fecha_nacimiento" data-required="true" />
            </div>

            <div class="field field-small">
              <label for="edad">Edad</label>
              <input type="number" id="edad" name="edad" readonly />
              <div class="help-text">
                Se calcula automáticamente a partir de tu fecha de nacimiento.
              </div>
            </div>

            <div class="field">
              <label for="departamento_expedicion">
                Departamento de expedición <span class="required">*</span>
              </label>
              <p class="field-help">Si se expidió en Bogotá, escoge D.C</p>
              <select id="departamento_expedicion" name="departamento_expedicion" data-required="true"></select>
            </div>

            <div class="field">
              <label for="ciudad_expedicion">
                Ciudad de expedición <span class="required">*</span>
              </label>

              <p class="field-help">&nbsp;</p>

              <select id="ciudad_expedicion" name="ciudad_expedicion" data-required="true"></select>
            </div>

            <div class="field">
              <label for="fecha_expedicion">
                Fecha de expedición <span class="required">*</span>
              </label>
              <input type="date" id="fecha_expedicion" name="fecha_expedicion" data-required="true" />
            </div>

            <div class="field">
              <label for="estado_civil">
                Estado civil <span class="required">*</span>
              </label>
              <select id="estado_civil" name="estado_civil" data-required="true">
                <option value="">Selecciona una opción</option>
                <option value="soltero">Soltero(a)</option>
                <option value="casado">Casado(a)</option>
                <option value="union_libre">Unión libre</option>
                <option value="divorciado">Divorciado(a)</option>
                <option value="viudo">Viudo(a)</option>
              </select>
            </div>

            <div class="field">
              <label for="direccion_barrio">
                Dirección y barrio <span class="required">*</span>
              </label>
              <input type="text" id="direccion_barrio" name="direccion_barrio" data-required="true" />
            </div>

            <div class="field">
              <label for="departamento_residencia">
                Departamento de residencia <span class="required">*</span>
              </label>
              <select id="departamento_residencia" name="departamento_residencia" data-required="true"></select>
            </div>

            <div class="field">
              <label for="ciudad_residencia">
                Ciudad de residencia <span class="required">*</span>
              </label>
              <select id="ciudad_residencia" name="ciudad_residencia" data-required="true"></select>
            </div>

            <div class="field">
              <label for="telefono">
                Teléfono / Celular <span class="required">*</span>
              </label>
              <input type="tel" id="telefono" name="telefono" data-required="true" />
            </div>

            <div class="field">
              <label for="correo_electronico">
                Correo electrónico <span class="required">*</span>
              </label>
              <input type="email" id="correo_electronico" name="correo_electronico" data-required="true" />
            </div>

            <div class="field">
              <label for="eps">
                EPS <span class="required">*</span>
              </label>
              <select id="eps" name="eps" data-required="true"></select>
            </div>

            <div class="field">
              <label for="afp">
                Fondo de pensión <span class="required">*</span>
              </label>
              <select id="afp" name="afp" data-required="true"></select>
            </div>

            <div class="field">
              <label for="rh">
                Grupo sanguíneo (RH) <span class="required">*</span>
              </label>
              <select id="rh" name="rh" data-required="true">
                <option value="">Selecciona una opción</option>
                <option value="A+">A+</option>
                <option value="A-">A-</option>
                <option value="B+">B+</option>
                <option value="B-">B-</option>
                <option value="AB+">AB+</option>
                <option value="AB-">AB-</option>
                <option value="O+">O+</option>
                <option value="O-">O-</option>
              </select>
            </div>

            <div class="field">
              <label for="talla_pantalon">
                Talla pantalón <span class="required">*</span>
              </label>
              <input type="text" id="talla_pantalon" name="talla_pantalon" data-required="true" />
            </div>

            <div class="field">
              <label for="camisa_talla">
                Talla camisa <span class="required">*</span>
              </label>
              <input type="text" id="camisa_talla" name="camisa_talla" data-required="true" />
            </div>

            <div class="field">
              <label for="zapatos_talla">
                Talla zapatos <span class="required">*</span>
              </label>
              <input type="text" id="zapatos_talla" name="zapatos_talla" data-required="true" />
            </div>

            <div class="field">
              <label>Firma <span class="required">*</span></label>

              <div class="signature-wrapper">
                <canvas id="signatureCanvas"></canvas>
              </div>

              <div class="signature-actions">
                <button type="button" class="btn btn-secondary btn-sm" onclick="clearSignature()">
                  Limpiar
                </button>
              </div>
            </div>

          </div>
          <div id="error-step-2" class="error-message"></div>
        </div>

        <!-- PASO 3: EDUCACIÓN -->
        <div class="form-step" data-step="3">
          <div class="step-title">Paso 3: Educación</div>
          <p class="help-text">
            Registra tus estudios realizados. Puedes agregar todos los que necesites.
          </p>

          <div id="educacion-list"></div>

          <button type="button" class="btn btn-primary" id="btn-add-educacion" style="margin-top: 10px;">
            ➕ Agregar estudio
          </button>

          <div id="error-step-3" class="error-message"></div>
        </div>

        <!-- PASO 4: EXPERIENCIA -->
        <div class="form-step" data-step="4">
          <div class="step-title">Paso 4: Experiencia laboral</div>
          <p class="help-text">
            Registra tus empleos anteriores. Puedes agregar tantos como necesites.
          </p>

          <div id="exp-list"></div>

          <button type="button" class="btn btn-primary" id="btn-add-exp" style="margin-top: 10px;">
            ➕ Agregar experiencia laboral
          </button>

          <div id="error-step-4" class="error-message"></div>
        </div>

        <!-- PASO 5: FAMILIA + REFERENCIAS -->
        <div class="form-step" data-step="5">
          <div class="step-title">Paso 5: Familiares y referencias</div>

          <p class="help-text">
            Registra tu núcleo familiar y las referencias que podamos contactar.
          </p>

          <!-- Familiares -->
          <div id="fam-list"></div>

          <button type="button" class="btn btn-primary" id="btn-add-fam" style="margin-top: 10px;">
            ➕ Agregar familiar
          </button>

          <div id="error-step-5" class="error-message" style="margin-top: 10px;"></div>

          <!-- Referencias -->
          <div style="margin-top: 28px;">
            <div class="step-title">Referencias</div>

            <div class="ref-card">
              <h4>Referencia laboral</h4>
              <div class="grid">
                <div class="field">
                  <label>Empresa</label>
                  <input type="text" id="ref_lab_empresa" />
                </div>
                <div class="field">
                  <label>Jefe inmediato</label>
                  <input type="text" id="ref_lab_jefe" />
                </div>
                <div class="field">
                  <label>Cargo</label>
                  <input type="text" id="ref_lab_cargo" />
                </div>
                <div class="field">
                  <label>Teléfono</label>
                  <input type="text" id="ref_lab_tel" />
                </div>
              </div>
            </div>

            <div class="ref-card">
              <h4>Referencia familiar</h4>
              <div class="grid">
                <div class="field">
                  <label>Nombre</label>
                  <input type="text" id="ref_fam_nombre" />
                </div>
                <div class="field">
                  <label>Parentesco</label>
                  <input type="text" id="ref_fam_parentesco" />
                </div>
                <div class="field">
                  <label>Teléfono</label>
                  <input type="text" id="ref_fam_tel" />
                </div>
                <div class="field">
                  <label>Ocupación</label>
                  <input type="text" id="ref_fam_ocupacion" />
                </div>
              </div>
            </div>

            <div class="ref-card">
              <h4>Referencia personal</h4>
              <div class="grid">
                <div class="field">
                  <label>Nombre</label>
                  <input type="text" id="ref_per_nombre" />
                </div>
                <div class="field">
                  <label>Relación</label>
                  <input type="text" id="ref_per_relacion" />
                </div>
                <div class="field">
                  <label>Teléfono</label>
                  <input type="text" id="ref_per_tel" />
                </div>
                <div class="field">
                  <label>Ocupación</label>
                  <input type="text" id="ref_per_ocupacion" />
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- PASO 6: EMERGENCIA + METAS -->
        <div class="form-step" data-step="6">
          <div class="step-title">Paso 6: Contacto de emergencia y metas</div>

          <p class="help-text">
            Indica a quién debemos contactar en caso de emergencia y cuéntanos tus metas.
          </p>

          <div class="grid">
            <div class="field">
              <label>Nombre completo (emergencia)</label>
              <input type="text" id="emer_nombre" />
            </div>

            <div class="field">
              <label>Parentesco</label>
              <input type="text" id="emer_parentesco" />
            </div>

            <div class="field">
              <label>Teléfono</label>
              <input type="tel" id="emer_telefono" />
            </div>

            <div class="field">
              <label>Correo electrónico</label>
              <input type="email" id="emer_correo" />
            </div>

            <div class="field" style="grid-column:span 2;">
              <label>Dirección</label>
              <input type="text" id="emer_direccion" />
            </div>
          </div>

          <div style="margin-top: 20px;">
            <div class="step-title">Metas personales</div>

            <div class="field">
              <label>Corto plazo</label>
              <textarea id="meta_corto" rows="2"></textarea>
            </div>

            <div class="field">
              <label>Mediano plazo</label>
              <textarea id="meta_mediano" rows="2"></textarea>
            </div>

            <div class="field">
              <label>Largo plazo</label>
              <textarea id="meta_largo" rows="2"></textarea>
            </div>
          </div>
        </div>

        <!-- PASO 7: CUESTIONARIO PERSONAL -->
        <div class="form-step" data-step="7">
          <div class="step-title">Paso 7: Cuestionario personal y seguridad</div>
          <p class="help-text">
            Responde con sinceridad. Esta información es confidencial y se usa solo para el proceso.
          </p>

          <div class="grid">
            <div class="field">
              <label>¿Has tenido llamados de atención?</label>
              <select id="seg_llamados">
                <option value="0">No</option>
                <option value="1">Sí</option>
              </select>
            </div>

            <div class="field hidden" id="detalle_llamados_wrap">
              <label>Describe los llamados de atención</label>
              <textarea id="seg_detalle_llamados" rows="2"></textarea>
            </div>

            <div class="field">
              <label>¿Has sufrido accidente laboral?</label>
              <select id="seg_accidente">
                <option value="0">No</option>
                <option value="1">Sí</option>
              </select>
            </div>

            <div class="field hidden" id="detalle_accidente_wrap">
              <label>Describe el accidente o enfermedad laboral</label>
              <textarea id="seg_detalle_accidente" rows="2"></textarea>
            </div>

            <div class="field">
              <label>¿Tienes alguna enfermedad importante?</label>
              <select id="seg_enfermedad">
                <option value="0">No</option>
                <option value="1">Sí</option>
              </select>
            </div>

            <div class="field hidden" id="detalle_enfermedad_wrap">
              <label>Describe la enfermedad</label>
              <textarea id="seg_detalle_enfermedad" rows="2"></textarea>
            </div>

            <div class="field">
              <label>¿Consumes alcohol?</label>
              <select id="seg_alcohol">
                <option value="0">No</option>
                <option value="1">Sí</option>
              </select>
            </div>

            <div class="field hidden" id="detalle_alcohol_wrap">
              <label>Frecuencia (si aplica)</label>
              <input type="text" id="seg_frecuencia" />
            </div>

            <div class="field">
              <label>¿Algún familiar trabaja aquí?</label>
              <select id="seg_familiar">
                <option value="0">No</option>
                <option value="1">Sí</option>
              </select>
            </div>

            <div class="field hidden" id="detalle_familiar_wrap">
              <label>Nombre del familiar y relación</label>
              <input type="text" id="seg_familiar_nombre" />
            </div>

            <div class="field">
              <label>¿Has suministrado información falsa?</label>
              <select id="seg_falsa">
                <option value="0">No</option>
                <option value="1">Sí</option>
              </select>
            </div>

            <div class="field">
              <label>¿Aceptas pruebas de validación o polígrafo de ser necesario?</label>
              <select id="seg_poligrafo">
                <option value="1">Sí</option>
                <option value="0">No</option>
              </select>
            </div>
          </div>

          <div class="field" style="margin-top:14px;">
            <label>Observaciones adicionales</label>
            <textarea id="seg_observaciones" rows="2"></textarea>
          </div>

          <div class="field">
            <label>¿Por qué crees que calificas para el cargo?</label>
            <textarea id="seg_califica" rows="2"></textarea>
          </div>

          <div class="field">
            <label>Fortalezas</label>
            <textarea id="seg_fortal" rows="2"></textarea>
          </div>

          <div class="field">
            <label>Aspectos por mejorar</label>
            <textarea id="seg_mejorar" rows="2"></textarea>
          </div>

          <div class="field">
            <label>Describe una situación difícil que enfrentaste y cómo la resolviste.</label>
            <textarea id="seg_resolucion" rows="2"></textarea>
          </div>
        </div>

        <!-- PASO 8: PREVISUALIZACIÓN -->
        <div class="form-step" data-step="8">
          <div class="step-title">Paso 8: Revisión y envío</div>
          <p class="help-text">
            Verifica un resumen de la información que registraste. Puedes volver a pasos anteriores si quieres corregir
            algo
            antes de enviar.
          </p>

          <div id="preview-container" class="preview-container"></div>
        </div>

        <!-- BOTONES -->
        <div class="buttons">
          <button type="button" class="btn btn-secondary" id="btn-prev" disabled>
            ⬅ Anterior
          </button>
          <div style="display:flex; gap:8px;">
            <button type="button" class="btn btn-primary" id="btn-next">
              Siguiente ➝
            </button>
            <button type="submit" class="btn btn-primary hidden" id="btn-submit">
              Enviar hoja de vida ✅
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- Confirm modal para eliminación de foto -->
  <div id="deletePhotoModalBackdrop" class="delete-modal-backdrop" aria-hidden="true" role="dialog"
    aria-labelledby="deletePhotoTitle" aria-modal="true">
    <div class="delete-modal-card" role="document">
      <p id="deletePhotoTitle" style="font-weight:600;">¿Está seguro de eliminar esta foto?</p>
      <p style="margin-top:4px; color:#666; font-size:0.95rem;">
        Esta acción eliminará la foto de la vista. Si quieres también eliminarla del servidor debes usar la opción de
        eliminar del perfil.
      </p>
      <div class="delete-modal-actions" style="margin-top:12px;">
        <button id="deleteModalCancel" class="btn btn-secondary">Cancelar</button>
        <button id="deleteModalConfirm" class="btn btn-primary">Eliminar</button>
      </div>
    </div>
  </div>

  <script src="./script.js"></script>
  <script src="./app.js"></script>
</body>

</html>